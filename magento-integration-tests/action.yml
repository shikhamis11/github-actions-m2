name: 'Magento 2 integration tests'
author: 'ExtDN'
description: 'runs integration tests for given Magento 2 open source version'
inputs:
  module_name:
    description: 'Your Magento module name. Example: Foo_Bar'
    required: true
  composer_name:
    description: 'Your composer name. Example: foo/magento2-bar'
    required: true
  ce_version:
    description: 'Magento 2 Open Source version number'
    required: true
    default: '2.4.0'
  php_version:
    description: 'Php version number'
    required: true
    default: '7.4'
  module_source:
    description: 'Relative path to your module source within your repository. Empty by default.'
    required: false
  phpunit_file:
    description: 'Relative path to your own PHPUnit file. Leave empty to use the default.'
    required: false
  magento_pre_install_script:
    description: 'Relative path to an optional script before Magento installation is run. Leave empty to use the default.'
    required: false
runs:
  using: 'docker'
  image: 'docker://extdn/magento-integration-tests-action:${{ inputs.php_version }}-latest'
  args:
    - "-e MAGENTO_MARKETPLACE_USERNAME=${{ secrets.MAGENTO_MARKETPLACE_USERNAME }}"
    - "-e MAGENTO_MARKETPLACE_PASSWORD=${{ secrets.MAGENTO_MARKETPLACE_PASSWORD }}"
    - "-e MODULE_NAME=${{ inputs.module_name }}"
    - "-e COMPOSER_NAME=${{ inputs.composer_name }}"
    - "-e MAGENTO_VERSION=${{ inputs.ce_version }}"

branding:
  icon: 'code'  
  color: 'green'

